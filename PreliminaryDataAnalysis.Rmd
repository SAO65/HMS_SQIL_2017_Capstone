---
title: "Preliminary Data Analysis"
author: "Olgiati Stefano"
date: "25 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Reading tidy data

```{r echo=FALSE}
library(data.table)

data.EU.1990 <- read.csv("Output_EU_1990.csv")
data.EU.2010 <- read.csv("Output_EU_2010.csv")
data.ROW.1990 <- read.csv("Output_ROW_1990.csv")
data.ROW.2010 <- read.csv("Output_ROW_2010.csv")

head(data.EU.1990)
head(data.EU.2010)
head(data.ROW.1990)
head(data.ROW.2010)

attach(data.EU.1990)
attach(data.EU.2010)
attach(data.ROW.1990)
attach(data.ROW.2010)

```


```{r}
ID.EU <- "GRC"
ID.ROW <- "USA"
```


# Expansion of Morbidity WORLD: 1990-2010

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(data.ROW.1990$le, data.ROW.1990$yld, main="Expansion of Morbidity \nWORLD: 1990-2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="snow4", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(data.EU.1990$le, data.EU.1990$yld, col="snow4", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(data.ROW.2010$le, data.ROW.2010$yld, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(data.EU.2010$le, data.EU.2010$yld,  col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(data.ROW.1990$yld), 0): round(max(data.ROW.1990$yld), 0)), col.axis="snow4", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(data.ROW.2010$yld), 0): round(max(data.ROW.2010$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "WORLD_1990", col="snow4")
text(40, 11, "WORLD_2010", col="skyblue")


points(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=4, offset = .7)

points(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=4, offset = .7)

points(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

points(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)

```


# Expansion of Morbidity EU-ROW: 1990

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(data.ROW.1990$le, data.ROW.1990$yld, main="Expansion of Morbidity \nEU-ROW: 1990", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30,90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(data.EU.1990$le, data.EU.1990$yld, col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(data.ROW.1990$yld), 0): round(max(data.ROW.1990$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(data.EU.1990$yld), 0): round(max(data.EU.1990$yld), 0)), col.axis="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "ROW_1990", col="blue")
text(40, 11, "EU_1990", col="red")

fun.ROW.1990 <- lm(data.ROW.1990$yld ~ data.ROW.1990$le)
fun.EU.1990 <- lm(data.EU.1990$yld ~ data.EU.1990$le)

abline(fun.ROW.1990, lty = 3, col="blue", lwd=1.5)
abline(fun.EU.1990, lty = 3, col="red", lwd=1.5)

points(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=4, offset = .7)

points(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

```



# Expansion of Morbidity EU-ROW: 2010

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(data.ROW.2010$le, data.ROW.2010$yld, main="Expansion of Morbidity \nEU-ROW: 2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30,90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(data.EU.2010$le, data.EU.2010$yld, col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(data.ROW.2010$yld), 0): round(max(data.ROW.2010$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(data.EU.2010$yld), 0): round(max(data.EU.2010$yld), 0)), col.axis="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "ROW_2010", col="blue")
text(40, 11, "EU_2010", col="red")

fun.ROW.2010 <- lm(data.ROW.2010$yld ~ data.ROW.2010$le)
fun.EU.2010 <- lm(data.EU.2010$yld ~ data.EU.2010$le)

abline(fun.ROW.2010, lty = 3, col="blue", lwd=1.5)
abline(fun.EU.2010, lty = 3, col="red", lwd=1.5)

points(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=4, offset = .7)

points(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)


```


# Expansion of Morbidity EU: 1990-2010

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(data.EU.2010$le, data.EU.2010$yld, main="Expansion of Morbidity \nEU: 1990-2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(data.EU.1990$le, data.EU.1990$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(data.EU.1990$yld), 0): round(max(data.EU.1990$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(data.EU.2010$yld), 0): round(max(data.EU.2010$yld), 0)), col.axis="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "EU_1990", col="blue")
text(40, 11, "EU_2010", col="red")

fun.EU.2010 <- lm(data.EU.2010$yld ~ data.EU.2010$le)
fun.EU.1990 <- lm(data.EU.1990$yld ~ data.EU.1990$le)

abline(lm(data.EU.1990$yld ~ data.EU.1990$le), lty = 3, col="blue", lwd=1.5)
abline(lm(data.EU.2010$yld ~ data.EU.2010$le), lty = 3, col="red", lwd=1.5)

points(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=2, offset = .7)

points(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=2, offset = .7)

points(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

points(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)

```


# The Hypothesis

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(data.ROW.1990$le, data.ROW.1990$yld, main="The Hypothesis", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="snow4", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(data.EU.1990$le, data.EU.1990$yld, col="snow4", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(data.ROW.2010$le, data.ROW.2010$yld, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(data.EU.2010$le, data.EU.2010$yld,  col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(data.ROW.1990$yld), 0): round(max(data.ROW.1990$yld), 0)), col.axis="snow4", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(data.ROW.2010$yld), 0): round(max(data.ROW.2010$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "WORLD_1990", col="snow4")
text(40, 11, "WORLD_2010", col="skyblue")

fun.EU.2010 <- lm(data.EU.2010$yld ~ data.EU.2010$le)

abline(lm(data.EU.2010$yld ~ data.EU.2010$le), lty = 1, col="red", lwd=1.5)

points(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.1990$le[data.EU.1990$country == ID.EU], data.EU.1990$yld[data.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=2, offset = .7)

points(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.EU.2010$le[data.EU.2010$country == ID.EU], data.EU.2010$yld[data.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=2, offset = .7)

points(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.1990$le[data.ROW.1990$country == ID.ROW], data.ROW.1990$yld[data.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

points(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(data.ROW.2010$le[data.ROW.2010$country == ID.ROW], data.ROW.2010$yld[data.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)

```


# Total Health Expenditure Growth

```{r}



```













# Growth of Nursing Density (per 1000 inhabitants) in the European Union


# Growth of Physicians Density (per 1000 inhabitants) in the European Union


# Hist of Nursing Density (per 1000 inhabitants) in the European Union


MyMean <- mean(rn)
MyMedian <- median(rn)
MySd <- sd(rn)
MyMad <- mad(rn)

hist(rn, main="", xlab="Nursing Density (per 1000 inhabitants)", ylab="Frequency")
text(13.5, 6, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$rn[data$country == ID],col="red")
text(7.3, 6, paste("ITA=", data$rn[data$country == ID]))



# Hist of Physicians Density (per 1000 inhabitants) in the European Union


MyMean <- mean(md)
MyMedian <- median(md)
MySd <- sd(md)
MyMad <- mad(md)

hist(md, main="", xlab="Physicians Density (per 1000 inhabitants)", ylab="Frequency")
text(2, 9, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$md[data$country == ID],col="red")
text(4.5, 9, paste("ITA=", data$md[data$country == ID]))




# Strip Charts

par(mfrow=c(1,2))

strip.data.1 <- data.frame("Nurses"=rn, "Physicians"= md)
stripchart(strip.data.1, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(rn), median(md)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$rn[data$country == ID], data$md[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$rn[data$country == ID], data$md[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.1)

strip.data.2 <- data.frame("THE"=the)
stripchart(strip.data.2, 
           vertical=TRUE,
           col=c("black"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Per Capita \n Total Health Expenditure",
           ylab="USD Int PPP")
abline(h=c(median(the)),col=c("black"),
           lty = "solid", 
           lwd = 2)
points(c(data$the[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$the[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.2)

par(mfrow=c(1,2))

strip.data.3 <- data.frame("Nurses"=CareX)
stripchart(strip.data.3, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareX)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareX[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareX[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.3)

strip.data.4 <- data.frame("Nurses"=CareV)
stripchart(strip.data.4, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareV)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareV[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareV[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.4)



