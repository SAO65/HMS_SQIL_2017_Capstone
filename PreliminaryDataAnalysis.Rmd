---
title: "Preliminary Data Analysis"
author: "Olgiati Stefano"
date: "25 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Reading tidy data

```{r echo=FALSE}
library(data.table)

data <- read.csv("Workforce_Output_EU.csv")

head(data)

attach(data)
```


```{r}
ID <- "ITA"

```

# Care Intensity, Care Index amd Care Value

CareI <- rn / md
TreatmentI <- md / yld
CareX <- CareI * TreatmentI <- (rn / md) * (md / yld) = rn / yld
CareV <- the * CareX

# Expansion of Morbidity in the European Union

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)
plot(le, yld, main="Expansion of Morbidity in the European Union", xlab="Life Expectancy at Birth", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(72,85), ylim=c(9, 13), axes=FALSE, frame.plot=FALSE)
axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)
axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)
mtext("Years Lived \nwith Disease", side=4, line=3, cex.lab=1,las=2, col="red")
abline(lm(yld ~ le), lty = 3, col="red")
points(data$le[data$country == ID], data$yld[data$country == ID], pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(data$le[data$country == ID], data$yld[data$country == ID], labels=ID, cex= 1, pos=4, offset = 1)

```


# Growth of Per Capita Total Health Expenditure in the European Union

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)
plot(yld, the, main="Growth of Health Expenditure \n in the European Union", xlab="Years Lived with Disease", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(9,13), ylim=NULL, axes=FALSE, frame.plot=FALSE)
axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)
axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)
mtext("Per Capita Total \n      Health \n  Expenditure", side=4, line=3, cex.lab=1,las=2, col="red")
abline(lm(the ~ yld), lty = 3, col="red")
points(data$yld[data$country == ID], data$the[data$country == ID], pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(data$yld[data$country == ID], data$the[data$country == ID], labels=ID, cex= 1, pos=4, offset = 1)
```


# Growth of Nursing Density (per 1000 inhabitants) in the European Union

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)
plot(the, rn, main="Growth of Nursing Density \n in the European Union", xlab="Per Capita Total Health Expenditure", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=NULL, ylim=NULL, axes=FALSE, frame.plot=FALSE)
axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)
axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)
mtext("Nursing Density", side=4, line=3, cex.lab=1,las=2, col="red")
abline(lm(rn ~ the), lty = 3, col="red")
points(data$the[data$country == ID], data$rn[data$country == ID], pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(data$the[data$country == ID], data$rn[data$country == ID], labels=ID, cex= 1, pos=4, offset = 1)
```

# Growth of Physicians Density (per 1000 inhabitants) in the European Union

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)
plot(the, md, main="Growth of Physicians Density \n in the European Union", xlab="Per Capita Total Health Expenditure", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=NULL, ylim=NULL, axes=FALSE, frame.plot=FALSE)
axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)
axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)
mtext("Physicians Density", side=4, line=3, cex.lab=1,las=2, col="red")
abline(lm(md ~ the), lty = 3, col="red")
points(data$the[data$country == ID], data$md[data$country == ID], pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(data$the[data$country == ID], data$md[data$country == ID], labels=ID, cex= 1, pos=4, offset = 1)
```

# Hist of Nursing Density (per 1000 inhabitants) in the European Union

```{r}
MyMean <- mean(rn)
MyMedian <- median(rn)
MySd <- sd(rn)
MyMad <- mad(rn)

hist(rn, main="", xlab="Nursing Density (per 1000 inhabitants)", ylab="Frequency")
text(13.5, 6, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$rn[data$country == ID],col="red")
text(7.3, 6, paste("ITA=", data$rn[data$country == ID]))

```


# Hist of Physicians Density (per 1000 inhabitants) in the European Union

```{r}
MyMean <- mean(md)
MyMedian <- median(md)
MySd <- sd(md)
MyMad <- mad(md)

hist(md, main="", xlab="Physicians Density (per 1000 inhabitants)", ylab="Frequency")
text(2, 9, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$md[data$country == ID],col="red")
text(4.5, 9, paste("ITA=", data$md[data$country == ID]))

```




# Strip Charts
```{r}
par(mfrow=c(1,2))

strip.data.1 <- data.frame("Nurses"=rn, "Physicians"= md)
stripchart(strip.data.1, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(rn), median(md)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$rn[data$country == ID], data$md[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$rn[data$country == ID], data$md[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.1)

strip.data.2 <- data.frame("THE"=the)
stripchart(strip.data.2, 
           vertical=TRUE,
           col=c("black"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Per Capita \n Total Health Expenditure",
           ylab="USD Int PPP")
abline(h=c(median(the)),col=c("black"),
           lty = "solid", 
           lwd = 2)
points(c(data$the[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$the[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.2)

par(mfrow=c(1,2))

strip.data.3 <- data.frame("Nurses"=CareX)
stripchart(strip.data.3, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareX)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareX[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareX[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.3)

strip.data.4 <- data.frame("Nurses"=CareV)
stripchart(strip.data.4, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareV)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareV[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareV[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.4)

```

