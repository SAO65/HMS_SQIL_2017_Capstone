---
title: "Preliminary Data Analysis"
author: "Olgiati Stefano"
date: "25 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Reading tidy data

```{r echo=FALSE}
library(data.table)

data.EU <- read.csv("Workforce_Output_EU.csv")
data.ROW <- read.csv("Workforce_Output_ROW.csv")


head(data.EU)
head(data.ROW)

attach(data.EU)
attach(data.ROW)
```


```{r}
ID <- "ITA"
```

# Care Intensity, Care Index amd Care Value

CareI <- rn / md
TreatmentI <- md / yld
CareX <- CareI * TreatmentI <- (rn / md) * (md / yld) = rn / yld
CareV <- the * CareX

# Expansion of Morbidity

```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(le.ROW, yld.ROW, main="Expansion of Morbidity", xlab="Life Expectancy at Birth", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30,90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(le.EU, yld.EU, main="Expansion of Morbidity", xlab="Life Expectancy at Birth", ylab="", col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)

axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)

mtext("Years Lived \nwith Disease", side=4, line=3, cex.lab=1,las=2, col="red")

abline(lm(yld.ROW ~ le.ROW), lty = 3, col="blue")
abline(lm(yld.EU ~ le.EU), lty = 3, col="red")


points(data.EU$le.EU[data.EU$country.EU == ID], data.EU$yld.EU[data.EU$country.EU == ID], pch=22, col="black", cex = 3, lty = "solid", lwd = 2)

text(data.EU$le.EU[data.EU$country.EU == ID], data.EU$yld.EU[data.EU$country.EU == ID], labels=ID, cex= 1, pos=4, offset = 1)

```


# Growth of Per Capita Total Health Expenditure in the European Union
```{r}
par(mar=c(5, 4, 4, 10) + 0.1)

plot(yld.ROW, the.ROW, main="Expansion of Morbidity", xlab="Life Expectancy at Birth", ylab="", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=NULL, ylim=NULL, axes=FALSE, frame.plot=FALSE)

points(yld.EU, the.EU, main="Expansion of Morbidity", xlab="Life Expectancy at Birth", ylab="", col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="blue", las=2, cex.axis=0.7, tck=-.01)

axis (4,col.axis="red", las=2, cex.axis=0.7, tck=-.01)

mtext("Years Lived \nwith Disease", side=4, line=3, cex.lab=1,las=2, col="red")

abline(lm(the.ROW ~ yld.ROW), lty = 3, col="blue")
abline(lm(the.EU ~ yld.EU), lty = 3, col="red")


points(data.EU$le.EU[data.EU$country.EU == ID], data.EU$yld.EU[data.EU$country.EU == ID], pch=22, col="black", cex = 3, lty = "solid", lwd = 2)

text(data.EU$le.EU[data.EU$country.EU == ID], data.EU$yld.EU[data.EU$country.EU == ID], labels=ID, cex= 1, pos=4, offset = 1)

```

# Growth of Nursing Density (per 1000 inhabitants) in the European Union


# Growth of Physicians Density (per 1000 inhabitants) in the European Union


# Hist of Nursing Density (per 1000 inhabitants) in the European Union

```{r}
MyMean <- mean(rn)
MyMedian <- median(rn)
MySd <- sd(rn)
MyMad <- mad(rn)

hist(rn, main="", xlab="Nursing Density (per 1000 inhabitants)", ylab="Frequency")
text(13.5, 6, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$rn[data$country == ID],col="red")
text(7.3, 6, paste("ITA=", data$rn[data$country == ID]))

```


# Hist of Physicians Density (per 1000 inhabitants) in the European Union

```{r}
MyMean <- mean(md)
MyMedian <- median(md)
MySd <- sd(md)
MyMad <- mad(md)

hist(md, main="", xlab="Physicians Density (per 1000 inhabitants)", ylab="Frequency")
text(2, 9, paste("Mean =", round(MyMean, 1), "\n Median =", round(MyMedian, 1), "\n Std.Dev =", round(MySd, 1)))
abline(v=data$md[data$country == ID],col="red")
text(4.5, 9, paste("ITA=", data$md[data$country == ID]))

```




# Strip Charts
```{r}
par(mfrow=c(1,2))

strip.data.1 <- data.frame("Nurses"=rn, "Physicians"= md)
stripchart(strip.data.1, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(rn), median(md)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$rn[data$country == ID], data$md[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$rn[data$country == ID], data$md[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.1)

strip.data.2 <- data.frame("THE"=the)
stripchart(strip.data.2, 
           vertical=TRUE,
           col=c("black"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Per Capita \n Total Health Expenditure",
           ylab="USD Int PPP")
abline(h=c(median(the)),col=c("black"),
           lty = "solid", 
           lwd = 2)
points(c(data$the[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$the[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.2)

par(mfrow=c(1,2))

strip.data.3 <- data.frame("Nurses"=CareX)
stripchart(strip.data.3, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareX)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareX[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareX[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.3)

strip.data.4 <- data.frame("Nurses"=CareV)
stripchart(strip.data.4, 
           vertical=TRUE,
           col=c("black", "skyblue"),
           cex=1.5,
           lty = "solid", 
           lwd = 2,
           method="jitter", 
           main="EU Workforce",
           ylab="Density (per 1000 population)")
abline(h=c(median(CareV)),col=c("black", "skyblue"),
           lty = "solid", 
           lwd = 2) 
points(c(data$CareV[data$country == ID]), pch=22, col="red", cex = 2, lty = "solid", lwd = 2)
text(c(data$CareV[data$country == ID]), labels=ID, cex= 1.5, pos=c(4,2))
summary(strip.data.4)

```

