---
title: "Preliminary Data Analysis"
author: "Olgiati Stefano"
date: "25 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Reading tidy data

```{r echo=FALSE}
library(data.table)

data.EU.1990 <- read.csv("Output_EU_1990.csv")
data.EU.2010 <- read.csv("Output_EU_2010.csv")
data.ROW.1990 <- read.csv("Output_ROW_1990.csv")
data.ROW.2010 <- read.csv("Output_ROW_2010.csv")

head(data.EU.1990)
head(data.EU.2010)
head(data.ROW.1990)
head(data.ROW.2010)

attach(data.EU.1990)
attach(data.EU.2010)
attach(data.ROW.1990)
attach(data.ROW.2010)

df.EU.1990 <- data.frame(country=data.EU.1990$country, le.1990=data.EU.1990$le,hale.1990=data.EU.1990$hale, yld.1990=data.EU.1990$yld, the.1990=data.EU.1990$the)
df.EU.2010 <- data.frame(country=data.EU.2010$country, le.2010=data.EU.2010$le,hale.2010=data.EU.2010$hale, yld.2010=data.EU.2010$yld, the.2010=data.EU.2010$the)
df.ROW.1990 <- data.frame(country=data.ROW.1990$country, le.1990=data.ROW.1990$le,hale.1990=data.ROW.1990$hale, yld.1990=data.ROW.1990$yld, the.1990=data.ROW.1990$the)
df.ROW.2010 <- data.frame(country=data.ROW.2010$country, le.2010=data.ROW.2010$le,hale.2010=data.ROW.2010$hale, yld.2010=data.ROW.2010$yld, the.2010=data.ROW.2010$the)

head(df.EU.1990)
head(df.EU.2010)
head(df.ROW.1990)
head(df.ROW.2010)

df.EU <- merge(df.EU.1990, df.EU.2010, by="country")
df.ROW <- merge(df.ROW.1990, df.ROW.2010, by="country")

head(df.EU)
head(df.ROW)

```


```{r}
ID.EU <- "FRA"
ID.ROW <- "USA"
```


# Expansion of Morbidity WORLD: 1990-2010

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.ROW.1990$le, df.ROW.1990$yld, main="Expansion of Morbidity \nWORLD: 1990-2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.1990$le, df.EU.1990$yld, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(df.ROW.2010$le, df.ROW.2010$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(df.EU.2010$le, df.EU.2010$yld,  col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(df.ROW.1990$yld), 0): round(max(df.ROW.1990$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(df.ROW.2010$yld), 0): round(max(df.ROW.2010$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "WORLD_1990", col="skyblue")
text(40, 11, "WORLD_2010", col="blue")


points(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=4, offset = .7)

points(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=4, offset = .7)

points(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

points(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)

```


# Expansion of Morbidity EU-ROW: 1990

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.ROW.1990$le, df.ROW.1990$yld, main="Expansion of Morbidity \nEU-ROW: 1990", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30,90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.1990$le, df.EU.1990$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(df.ROW.1990$yld), 0): round(max(df.ROW.1990$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(df.EU.1990$yld), 0): round(max(df.EU.1990$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "ROW_1990", col="skyblue")
text(40, 11, "EU_1990", col="blue")

fun.ROW.1990 <- lm(df.ROW.1990$yld ~ df.ROW.1990$le)
fun.EU.1990 <- lm(df.EU.1990$yld ~ df.EU.1990$le)

abline(fun.ROW.1990, lty = 3, col="skyblue", lwd=1.5)
abline(fun.EU.1990, lty = 3, col="blue", lwd=1.5)

points(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=4, offset = .7)

points(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

```



# Expansion of Morbidity EU-ROW: 2010

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.ROW.2010$le, df.ROW.2010$yld, main="Expansion of Morbidity \nEU-ROW: 2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30,90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.2010$le, df.EU.2010$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(df.ROW.2010$yld), 0): round(max(df.ROW.2010$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(df.EU.2010$yld), 0): round(max(df.EU.2010$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "ROW_2010", col="skyblue")
text(40, 11, "EU_2010", col="blue")

fun.ROW.2010 <- lm(df.ROW.2010$yld ~ df.ROW.2010$le)
fun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$le)

abline(fun.ROW.2010, lty = 3, col="skyblue", lwd=1.5)
abline(fun.EU.2010, lty = 3, col="blue", lwd=1.5)

points(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=4, offset = .7)

points(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)


```


# Expansion of Morbidity EU: 1990-2010

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.EU.2010$le, df.EU.2010$yld, main="Expansion of Morbidity \nEU: 1990-2010", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.1990$le, df.EU.1990$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(df.EU.1990$yld), 0): round(max(df.EU.1990$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(df.EU.2010$yld), 0): round(max(df.EU.2010$yld), 0)), col.axis="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "EU_1990", col="blue")
text(40, 11, "EU_2010", col="red")

fun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$le)
fun.EU.1990 <- lm(df.EU.1990$yld ~ df.EU.1990$le)

abline(lm(df.EU.1990$yld ~ df.EU.1990$le), lty = 3, col="blue", lwd=1.5)
abline(lm(df.EU.2010$yld ~ df.EU.2010$le), lty = 3, col="red", lwd=1.5)

points(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU], labels=paste(ID.EU, "1990"), cex= .8, pos=2, offset = .7)

points(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], pch=2, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU], labels=paste(ID.EU, "2010"), cex= .8, pos=2, offset = .7)

points(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.1990$le[df.ROW.1990$country == ID.ROW], df.ROW.1990$yld[df.ROW.1990$country == ID.ROW], labels=paste(ID.ROW, "1990"), cex= .8, pos=4, offset = 1)

points(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], pch=21, col="black", cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], labels=paste(ID.ROW, "2010"), cex= .8, pos=4, offset = 1)

```


# The Hypothesis

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.ROW.1990$le, df.ROW.1990$yld, main="The Hypothesis", xlab="Life Expectancy at Birth (LE)", ylab="Years Lived with Disease (YLD)", col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 90), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.1990$le, df.EU.1990$yld, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(df.ROW.2010$le, df.ROW.2010$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(df.EU.2010$le, df.EU.2010$yld,  col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, col.axis="black", las=2, cex.axis=0.7, tick=-.01)

axis(2, at=(round(min(df.ROW.1990$yld), 0): round(max(df.ROW.1990$yld), 0)), col.axis="skyblue", las=2, cex.axis=0.7, tick=-.01)

axis(4, at=(round(min(df.ROW.2010$yld), 0): round(max(df.ROW.2010$yld), 0)), col.axis="blue", las=2, cex.axis=0.7, tick=-.01)

text(40, 12, "WORLD_1990", col="skyblue")
text(40, 11, "WORLD_2010", col="blue")

fun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$le)


abline(fun.EU.2010, lty = 6, col="red", lwd=2)

```


# Quality, Cost and Value EU - ROW: 1990

```{r}

QUALITY.EU <- 1- (df.EU$yld.1990 / df.EU$le.1990)
QUALITY.ROW <- 1- (df.ROW$yld.1990 /  df.ROW$le.1990)

VALUE.EU <- df.EU$the.1990 * QUALITY.EU
VALUE.ROW <- df.ROW$the.1990 * QUALITY.ROW

plot(df.ROW$the.1990 , QUALITY.ROW, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, ylim=c(.82,.9))
points(df.EU$the.1990 , QUALITY.EU, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)



```


# Quality, Cost and Value EU - ROW: 2010

```{r}

QUALITY.EU <- 1- (df.EU$yld.2010 / df.EU$le.2010)
QUALITY.ROW <- 1- (df.ROW$yld.2010 /  df.ROW$le.2010)

VALUE.EU <- df.EU$the.2010 * QUALITY.EU
VALUE.ROW <- df.ROW$the.2010 * QUALITY.ROW

plot(df.ROW$the.2010 , QUALITY.ROW, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2,ylim=c(.82,.9))
points(df.EU$the.2010 , QUALITY.EU, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

```


# Quality, Cost and Value EU: 1990-2010

```{r}

QUALITY.EU.1990 <- 1- (df.EU$yld.1990 / df.EU$le.1990)
QUALITY.EU.2010 <- 1- (df.EU$yld.2010 / df.EU$le.2010)

VALUE.EU.1990 <- df.EU$the.1990 * QUALITY.EU.1990
VALUE.EU.2010 <- df.EU$the.2010 * QUALITY.EU.2010

plot(df.EU$the.2010 , QUALITY.EU.2010, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2,ylim=c(.82,.9))
points(df.EU$the.1990, QUALITY.EU.1990, col="skyblue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

fun.EU.1990 <- lm(df.EU$the.1990 ~ QUALITY.EU.1990)
fun.EU.2010 <- lm(df.EU$the.2010 ~ QUALITY.EU.2010)

abline(fun.EU.1990, lty = 6, col="red", lwd=2)


```

