---
title: "Preliminary Data Analysis"
author: "Olgiati Stefano"
date: "25 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Reading tidy data

```{r echo=FALSE}
library(data.table)

data.EU.1990 <- read.csv("Output_EU_1990.csv")
data.EU.2010 <- read.csv("Output_EU_2010.csv")
data.ROW.1990 <- read.csv("Output_ROW_1990.csv")
data.ROW.2010 <- read.csv("Output_ROW_2010.csv")

head(data.EU.1990)
head(data.EU.2010)
head(data.ROW.1990)
head(data.ROW.2010)

attach(data.EU.1990)
attach(data.EU.2010)
attach(data.ROW.1990)
attach(data.ROW.2010)

df.EU.1990 <- data.frame(country=data.EU.1990$country, le.1990=data.EU.1990$le,hale.1990=data.EU.1990$hale, yld.1990=data.EU.1990$yld, the.1990=data.EU.1990$the)

df.EU.2010 <- data.frame(country=data.EU.2010$country, le.2010=data.EU.2010$le,hale.2010=data.EU.2010$hale, yld.2010=data.EU.2010$yld, the.2010=data.EU.2010$the, rn=data.EU.2010$rn, md=data.EU.2010$md)

df.ROW.1990 <- data.frame(country=data.ROW.1990$country, le.1990=data.ROW.1990$le,hale.1990=data.ROW.1990$hale, yld.1990=data.ROW.1990$yld, the.1990=data.ROW.1990$the)

df.ROW.2010 <- data.frame(country=data.ROW.2010$country, le.2010=data.ROW.2010$le,hale.2010=data.ROW.2010$hale, yld.2010=data.ROW.2010$yld, the.2010=data.ROW.2010$the, rn=data.ROW.2010$rn, md=data.ROW.2010$md)

head(df.EU.1990)
head(df.EU.2010)
head(df.ROW.1990)
head(df.ROW.2010)

QUALITY.EU.1990 <- df.EU$hale.1990 / df.EU$yld.1990
QUALITY.ROW.1990 <- df.ROW$hale.1990 /  df.ROW$yld.1990

QUALITY.EU.2010 <- df.EU$hale.2010 / df.EU$yld.2010
QUALITY.ROW.2010 <- df.ROW$hale.2010 /  df.ROW$yld.2010

VALUE.EU.1990 <-  QUALITY.EU.1990 / df.EU$the.1990 * 100
VALUE.ROW.1990 <-  QUALITY.ROW.1990 / df.ROW$the.1990 * 100

VALUE.EU.2010 <-  QUALITY.EU.2010 / df.EU$the.2010* 100
VALUE.ROW.2010 <-  QUALITY.ROW.2010 / df.ROW$the.2010* 100

df.EU <- merge(df.EU.1990, df.EU.2010, by="country")
df.ROW <- merge(df.ROW.1990, df.ROW.2010, by="country")

head(df.EU)
head(df.ROW)

df.EU$QUALITY.EU.1990 <- QUALITY.EU.1990
df.EU$VALUE.EU.1990 <- VALUE.EU.1990
df.EU$QUALITY.EU.2010 <- QUALITY.EU.2010
df.EU$VALUE.EU.2010 <- VALUE.EU.2010

head(df.EU)

df.ROW$QUALITY.ROW.1990 <- QUALITY.ROW.1990
df.ROW$VALUE.ROW.1990 <- VALUE.ROW.1990
df.ROW$QUALITY.ROW.2010 <- QUALITY.ROW.2010
df.ROW$VALUE.ROW.2010 <- VALUE.ROW.2010

head(df.ROW)

```


```{r}
ID.EU <- "ITA"
ID.ROW.1 <- "JPN"
ID.ROW.2 <- "USA"
```


# Expansion of Morbidity WORLD: 1990-2010

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.ROW.1990$hale, df.ROW.1990$yld, xlab="Health Adjusted Life Expectancy at Birth (hale)", ylab="Years Lived with Disease (YLD)", col="grey", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 75), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.ROW.2010$hale, df.ROW.2010$yld, col="darkslategrey", pch = 16, cex = 1.3, lty = "solid", lwd = 2)


points(df.EU.1990$hale, df.EU.1990$yld, col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

points(df.EU.2010$hale, df.EU.2010$yld,  col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)


axis(1, at=(round(min(df.EU.1990$hale), 0): round(max(df.EU.1990$hale), 0)), col.axis="blue", col="blue", las=1, cex.axis=0.7,  tick=-.01)

axis(2, at=(round(min(df.EU.1990$yld), 0): round(max(df.EU.1990$yld), 0)), col.axis="blue", col="blue",las=2, cex.axis=0.7, tick=-.01)

axis(3, at=(round(min(df.EU.2010$hale), 0): round(max(df.EU.2010$hale), 0)), col.axis="red", col="red",las=1, cex.axis=0.7,  tick=-.01)

axis(4, at=(round(min(df.EU.2010$yld), 0): round(max(df.EU.2010$yld), 0)), col.axis="red", col="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 14, "minMAX EU 1990", col="blue")
text(40, 13, "minMAX EU 2010", col="red")

text(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW.1], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW.1]+.3, labels=paste(ID.ROW.1, ""), cex= .8, pos=4, offset = .2)

abline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW.1], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW.1], lty=1, lwd=1)

ID.min = df.ROW.2010$country[df.ROW.2010$yld.2010 == min(df.ROW.2010$yld.2010)]
ID.min

ID.max = df.ROW.2010$country[df.ROW.2010$yld.2010 == max(df.ROW.2010$yld.2010)]
ID.max

text(df.ROW.2010$hale.2010[df.ROW.2010$country == ID.min], df.ROW.2010$yld.2010[df.ROW.2010$country == ID.min]+.2, labels=ID.min, cex= .8, pos=4, offset = .2)

text(df.ROW.2010$hale.2010[df.ROW.2010$country == ID.max], df.ROW.2010$yld.2010[df.ROW.2010$country == ID.max]+.2, labels=ID.max, cex= .8, pos=4, offset = .2)

```



# Acceleration of Expansion of Morbidity EU: 1990-2010

```{r}
par(mar=c(5, 4, 4, 5) + 0.1)

plot(df.EU.1990$hale, df.EU.1990$yld, xlab="Health Adjusted Life Expectancy at Birth (hale)", ylab="Years Lived with Disease (YLD)", col="blue", pch = 16, cex = 1.3, lty = "solid", lwd = 2, xlim=c(30, 75), ylim=c(4, 15), axes=FALSE, frame.plot=FALSE)

points(df.EU.2010$hale, df.EU.2010$yld,  col="red", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

axis(1, at=(round(min(df.EU.1990$hale), 0): round(max(df.EU.1990$hale), 0)), col.axis="blue", col="blue", las=1, cex.axis=0.7,  tick=-.01)

axis(2, at=(round(min(df.EU.1990$yld), 0): round(max(df.EU.1990$yld), 0)), col.axis="blue", col="blue",las=2, cex.axis=0.7, tick=-.01)

axis(3, at=(round(min(df.EU.2010$hale), 0): round(max(df.EU.2010$hale), 0)), col.axis="red", col="red",las=1, cex.axis=0.7,  tick=-.01)

axis(4, at=(round(min(df.EU.2010$yld), 0): round(max(df.EU.2010$yld), 0)), col.axis="red", col="red", las=2, cex.axis=0.7, tick=-.01)

text(40, 14, "minMAX EU 1990", col="blue")
text(40, 13, "minMAX EU 2010", col="red")

points(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW.1], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW.1], col="black", pch = 16, cex = 1.3, lty = "solid", lwd = 2)

text(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW.1], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW.1]+.3, labels=paste(ID.ROW.1, ""), cex= .8, pos=4, offset = .2)

abline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW.1], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW.1], lty=1, lwd=1)


fun.EU.1990 <- lm(df.EU.1990$yld ~ df.EU.1990$hale)
abline(fun.EU.1990, lty = 2, col="blue", lwd=1.5)
summary(fun.EU.1990)

fun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$hale)
abline(fun.EU.2010, lty = 2, col="red", lwd=1.5)
summary(fun.EU.2010)


```



