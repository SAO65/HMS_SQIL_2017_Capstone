{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Tidy Data\"\nauthor: \"Olgiati Stefano (1)\"\ndate: \"21 May 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n(1) Author Responsible For Correspondence: University of Bergamo <www.unibg.it>, Department of Quantitative Methods, via dei Caniana 2, Bergamo (ITA) 24129; tel  +39 035 20 52 638; fax +39 035 20 52 549; email <stefano.olgiati@unibg.it>\n\n# Reading raw data in .csv format\n\n```{r}\nlibrary(data.table)\n\nraw.data.GBD <- read.csv(\"GBD.csv\")\nraw.data.WHO.WF <- read.csv(\"WHO_WF.csv\")\nraw.data.WHO.THE <- read.csv(\"WHO_THE.csv\")\nraw.data.WHO.THE.GDP <- read.csv2(\"API_NY.GDP.PCAP.PP.CD_DS2_en_excel_v2.csv\", skip=3)\n\n\nnames(raw.data.GBD)\nnames(raw.data.WHO.WF)\nnames(raw.data.WHO.THE)\nnames(raw.data.WHO.THE.GDP)\n\n\nhead(raw.data.GBD)\nhead(raw.data.WHO.WF)\nhead(raw.data.WHO.THE)\nhead(raw.data.WHO.THE.GDP)\n\n\ndim(raw.data.GBD)\ndim(raw.data.WHO.WF)\ndim(raw.data.WHO.THE)\ndim(raw.data.WHO.THE.GDP)\n\n\n# Data Tables\nattach(raw.data.GBD)\nattach(raw.data.WHO.WF)\nattach(raw.data.WHO.THE)\nattach(raw.data.WHO.THE.GDP)\n\n\nDT.GBD <- data.table(raw.data.GBD)\nDT.WHO.WF <- data.table(raw.data.WHO.WF)\nDT.WHO.THE <- data.table(raw.data.WHO.THE)\nDT.WHO.THE.GDP <- data.table(raw.data.WHO.THE.GDP)\ntables()\n```\n\n\n### Tidy Data Set\n\nInput parameters\n\n```{r}\n# ISO3 codes of EU-28 Countries\n\n# Austria, Belgium, Bulgaria, Croatia, Republic of Cyprus, Czech Republic, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Ireland, Italy, Latvia, Lithuania, Luxembourg, Malta, Netherlands, Poland, Portugal, Romania, Slovakia, Slovenia, Spain, Sweden and the UK\n\nISO3 <- c(\"AUT\",\"BEL\",\"BGR\",\"HRV\",\"CYP\",\"CZE\",\"DNK\",\"EST\",\"FIN\",\"FRA\",\"DEU\",\"GRC\",\"HUN\",\"IRL\",\"ITA\",\"LVA\",\"LTU\",\"LUX\",\"MLT\",\"NLD\",\"POL\",\"PRT\",\"ROU\",\"SVK\",\"SVN\",\"ESP\",\"SWE\",\"GBR\")\n\nlength(ISO3) == 28\n\noutput_year <- \"1990\"\n\noutput_year_THE <- if (output_year == \"1990\") {\n        print(\"1995\")\n} else {\n        print(\"2010\")\n        }\n\noutput_year\noutput_year_THE\n\n```\n\n\n\nManipulating data to generate tidy datasets\n\n```{r}\ndata.GBD <- DT.GBD[DT.GBD$year == output_year & \n                                DT.GBD$age_name == \"0-1 years\" &\n                                DT.GBD$sex_name == \"Both\" &\n                                DT.GBD$iso3 %in% ISO3, ]\ndf.GBD <- data.frame(country=data.GBD$iso3, le=data.GBD$le, hale=data.GBD$hale)\ndf.GBD\n\ndata.WHO.THE <- DT.WHO.THE[DT.WHO.THE$YEAR == output_year_THE & \n                                        DT.WHO.THE$GHO == \"WHS7_105\" & \n                                        DT.WHO.THE$Numeric != \"NA\" &\n                                        DT.WHO.THE$COUNTRY %in% ISO3,  ]\ndf.WHO.THE <- data.frame(country=data.WHO.THE$COUNTRY, the=data.WHO.THE$Numeric)\ndf.WHO.THE\n\nDT.WHO.THE.GDP\ndata.WHO.THE.GDP <- DT.WHO.THE.GDP[DT.WHO.THE.GDP$Country.Code %in% ISO3, ]\ndata.WHO.THE.GDP\n                                           \n\ndf.merge.1 <- merge(df.GBD, df.WHO.THE, all.x=F, by=\"country\")\ndf.merge.1\n\nintermediate.data <- merge(df.merge.1, df.WHO.THE.GDP, all.x=F, all.y=FALSE, by=\"country\")\nintermediate.data\n\n# Years Lived with Disability and GDP\nyld <- intermediate.data$le - intermediate.data$hale\ngdp <- round(intermediate.data$the / intermediate.data$the.gdp, 0) * 100\n\n# Tidy Dataset\ntidy.data <- data.frame(intermediate.data, yld, gdp)\ntidy.data\n\nattach(tidy.data)\n\n# Saving Tidy Dataset to .csv file\nfile_name <- paste(\"Output_EU_\", output_year, \".csv\", sep=\"\" )\nfile_name\nwrite.csv(tidy.data, file_name)\n```\n\n\n",
    "created" : 1466508142587.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3634559894",
    "id" : "2CEF2BBE",
    "lastKnownWriteTime" : 1466515464,
    "last_content_update" : 1466515464343,
    "path" : "~/Desktop/Capstone/HMS_SQIL_2017_Capstone/TidyData_EU.Rmd",
    "project_path" : "TidyData_EU.Rmd",
    "properties" : {
        "source_window_id" : ""
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}