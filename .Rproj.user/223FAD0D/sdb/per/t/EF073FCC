{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Preliminary Data Analysis\"\nauthor: \"Olgiati Stefano\"\ndate: \"25 May 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nrequire(data.table)\n\n```\n\n# Reading tidy data\n\n```{r echo=FALSE}\n\n\ndata.EU.1990 <- read.csv(\"Output_EU_1990.csv\")\ndata.EU.2010 <- read.csv(\"Output_EU_2010.csv\")\ndata.ROW.1990 <- read.csv(\"Output_ROW_1990.csv\")\ndata.ROW.2010 <- read.csv(\"Output_ROW_2010.csv\")\n\nhead(data.EU.1990)\nhead(data.EU.2010)\nhead(data.ROW.1990)\nhead(data.ROW.2010)\n\nattach(data.EU.1990)\nattach(data.EU.2010)\nattach(data.ROW.1990)\nattach(data.ROW.2010)\n\ndf.EU.1990 <- data.frame(country=data.EU.1990$country, le=data.EU.1990$le, hale=data.EU.1990$hale, yld=data.EU.1990$yld, the=data.EU.1990$the, gdp=data.EU.1990$gdp, the.gdp=data.EU.1990$the.gdp)\n\ndf.EU.2010 <- data.frame(country=data.EU.2010$country, le=data.EU.2010$le,hale=data.EU.2010$hale, yld=data.EU.2010$yld, the=data.EU.2010$the, gdp=data.EU.2010$gdp, the.gdp=data.EU.2010$the.gdp)\n\ndf.ROW.1990 <- data.frame(country=data.ROW.1990$country, le=data.ROW.1990$le,hale=data.ROW.1990$hale, yld=data.ROW.1990$yld, the=data.ROW.1990$the, gdp=data.ROW.1990$gdp, the.gdp=data.ROW.1990$the.gdp)\n\ndf.ROW.2010 <- data.frame(country=data.ROW.2010$country, le=data.ROW.2010$le,hale=data.ROW.2010$hale, yld=data.ROW.2010$yld, the=data.ROW.2010$the, gdp=data.ROW.2010$gdp, the.gdp=data.ROW.2010$the.gdp)\n\ndf.EU.1990\ndf.EU.2010\ndf.ROW.1990\ndf.ROW.2010\n\nID.ROW <- \"JPN\"\nID.EU <- \"ITA\"\n\n# Constant Scale in Graphs\n\nlim.le <- c(30, 85)\nlim.yld <- c(4, 15)\nlim.hale <- c(30, 85)\nlim.the <- c(100, 8500)\nlim.gdp <- c(1000, 87500)\n\n```\n\n\n\n# Expansion of Morbidity WORLD: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.ROW.1990$hale, df.ROW.1990$yld, xlab=\"Health Adjusted Life Expectancy at Birth (hale)\", ylab=\"Years Lived with Disease (YLD)\", type=\"p\", col=\"grey\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.hale, ylim=lim.yld, axes=FALSE, frame.plot=FALSE)\n\npoints(df.ROW.2010$hale, df.ROW.2010$yld, col=\"darkslategrey\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\n\npoints(df.EU.1990$hale, df.EU.1990$yld, col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$hale, df.EU.2010$yld,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\naxis(1, at=c(round(min(df.EU.1990$hale), 1), round(median(df.EU.1990$hale), 1), round(max(df.EU.1990$hale), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(2, at=c(round(min(df.EU.1990$yld), 1), round(median(df.EU.1990$yld), 1), round(max(df.EU.1990$yld), 1)), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=round(df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$hale), 1), round(median(df.EU.2010$hale), 1), round(max(df.EU.2010$hale), 1)), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7,  tick=-.01)\n\naxis(4, at=c(round(min(df.EU.2010$yld), 1), round(median(df.EU.2010$yld), 1), round(max(df.EU.2010$yld), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlegend(30, 15, c(\"EU 1990\",\"EU 2010\",\"ROW 1990\", \"ROW 2010\"), col=c(\"blue\", \"red\", \"grey\", \"darkslategrey\"), bty=\"n\", y.intersp=1.5, pch=c(16,16,16,16), cex = .75)\n\n\ntext(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW]+.3, labels=paste(ID.ROW, \"\"), cex= .8, pos=4, offset = .2)\n\nabline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\n```\n\n\n\n# Increased Expansion of Morbidity EU: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.EU.1990$hale, df.EU.1990$yld, xlab=\"Health Adjusted Life Expectancy at Birth (hale)\", ylab=\"Years Lived with Disease (YLD)\", col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.hale, ylim=lim.yld, axes=FALSE, frame.plot=FALSE)\n\npoints(df.EU.2010$hale, df.EU.2010$yld,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.1990$hale[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU],  col=\"black\", pch = 5, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$hale[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU],  col=\"black\", pch = 9, cex = 1.3, lty = \"solid\", lwd = 2)\n\naxis(1, at=c(round(min(df.EU.1990$hale), 1), round(median(df.EU.1990$hale), 1), round(max(df.EU.1990$hale), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(2, at=c(round(min(df.EU.1990$yld), 1), round(median(df.EU.1990$yld), 1), round(max(df.EU.1990$yld), 1)), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=round(df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$hale), 1), round(median(df.EU.2010$hale), 1), round(max(df.EU.2010$hale), 1)), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7,  tick=-.01)\n\naxis(4, at=c(round(min(df.EU.2010$yld), 1), round(median(df.EU.2010$yld), 1), round(max(df.EU.2010$yld), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlegend(30, 15, c(\"EU 1990\",\"EU 2010\",\"ITA 1990\", \"ITA 2010\", \"JPN 2010\"), col=c(\"blue\", \"red\", \"black\", \"black\", \"black\"), bty=\"n\", y.intersp=1.5, pch=c(16,16, 5, 9, 8), cex = .75)\n\npoints(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\nabline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\nfun.EU.1990 <- lm(df.EU.1990$yld ~ df.EU.1990$hale)\nabline(fun.EU.1990, lty = 2, col=\"blue\", lwd=1.5)\nsummary(fun.EU.1990)\nconfint(fun.EU.1990)\n\nfun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$hale)\nabline(fun.EU.2010, lty = 2, col=\"red\", lwd=1.5)\nsummary(fun.EU.2010)\nconfint(fun.EU.2010)\n\n```\n\n\n\n# Growth of Health Expenditure EU: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.EU.1990$le, df.EU.1990$the, xlab=\"Life Expectancy at Birth\", ylab=\"Per Capita Total Health Expenditure\", col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.le, ylim=lim.the, axes=FALSE, frame.plot=FALSE)\n\npoints(df.EU.2010$le, df.EU.2010$the,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$the[df.EU.1990$country == ID.EU],  col=\"black\", pch = 5, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$the[df.EU.2010$country == ID.EU],  col=\"black\", pch = 9, cex = 1.3, lty = \"solid\", lwd = 2)\n\nlegend(35, 7000, c(\"EU 1990\",\"EU 2010\",\"ITA 1990\", \"ITA 2010\", \"JPN 2010\"), col=c(\"blue\", \"red\", \"black\", \"black\", \"black\"), bty=\"n\", y.intersp=1.5, pch=c(16,16, 5, 9, 8), cex = .75)\n\naxis(1, at=c(round(min(df.EU.1990$le), 1), round(median(df.EU.1990$le), 1), round(max(df.EU.1990$le), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\n\nlow.the.1990 <- round(min(df.EU.1990$the), 0)\nmedian.the.1990 <- round(median(df.EU.1990$the), 0)\nhigh.the.1990 <- round(max(df.EU.1990$the), 0)\n\naxis(2, at=c(low.the.1990,median.the.1990, high.the.1990), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$le), 1), round(median(df.EU.2010$le), 1), round(max(df.EU.2010$le), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlow.the.2010 <- round(min(df.EU.2010$the), 0)\nmedian.the.2010 <- round(median(df.EU.2010$the), 0)\nhigh.the.2010 <- round(max(df.EU.2010$the), 0)\njapan.the.2010 <- round(df.ROW.2010$the[df.ROW.2010$country == ID.ROW], 1)\n\naxis(4, at=c(low.the.2010,median.the.2010, high.the.2010), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=japan.the.2010, col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\npoints(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$the[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\nabline(h=df.ROW.2010$the[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$le[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\nfun.EU.1990 <- lm(df.EU.1990$the ~ df.EU.1990$le)\nabline(fun.EU.1990, lty = 2, col=\"blue\", lwd=1.5)\n\nfun.EU.2010 <- lm(df.EU.2010$the ~ df.EU.2010$le)\nabline(fun.EU.2010, lty = 2, col=\"red\", lwd=1.5)\n\nsummary(fun.EU.1990)\nsummary(fun.EU.2010)\n\nconfint(fun.EU.1990)\nconfint(fun.EU.2010)\n\n```\n\n# Expansion of Health Expenditure EU: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.EU.1990$gdp, df.EU.1990$the, xlab=\"Per Capita Gross Domestic Product\", ylab=\"Per Capita Total Health Expenditure\", col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.gdp, ylim=lim.the, axes=FALSE, frame.plot=FALSE)\n\npoints(df.EU.2010$gdp, df.EU.2010$the,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.1990$gdp[df.EU.1990$country == ID.EU], df.EU.1990$the[df.EU.1990$country == ID.EU],  col=\"black\", pch = 5, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$gdp[df.EU.2010$country == ID.EU], df.EU.2010$the[df.EU.2010$country == ID.EU],  col=\"black\", pch = 9, cex = 1.3, lty = \"solid\", lwd = 2)\n\nlegend(1000, 7000, c(\"EU 1990\",\"EU 2010\",\"ITA 1990\", \"ITA 2010\", \"JPN 2010\"), col=c(\"blue\", \"red\", \"black\", \"black\", \"black\"), bty=\"n\", y.intersp=1.5, pch=c(16,16, 5, 9, 8), cex = .75)\n\naxis(1, at=c(round(min(df.EU.1990$gdp), 1), round(median(df.EU.1990$gdp), 1), round(max(df.EU.1990$gdp), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$gdp[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\n\nlow.the.1990 <- round(min(df.EU.1990$the), 0)\nmedian.the.1990 <- round(median(df.EU.1990$the), 0)\nhigh.the.1990 <- round(max(df.EU.1990$the), 0)\n\naxis(2, at=c(low.the.1990,median.the.1990, high.the.1990), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$gdp), 1), round(median(df.EU.2010$gdp), 1), round(max(df.EU.2010$gdp), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlow.the.2010 <- round(min(df.EU.2010$the), 0)\nmedian.the.2010 <- round(median(df.EU.2010$the), 0)\nhigh.the.2010 <- round(max(df.EU.2010$the), 0)\njapan.the.2010 <- round(df.ROW.2010$the[df.ROW.2010$country == ID.ROW], 1)\n\naxis(4, at=c(low.the.2010,median.the.2010, high.the.2010), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=japan.the.2010, col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\npoints(df.ROW.2010$gdp[df.ROW.2010$country == ID.ROW], df.ROW.2010$the[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\nabline(h=df.ROW.2010$the[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$gdp[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\nfun.EU.1990 <- lm(df.EU.1990$the ~ df.EU.1990$gdp)\nabline(fun.EU.1990, lty = 2, col=\"blue\", lwd=1.5)\n\nfun.EU.2010 <- lm(df.EU.2010$the ~ df.EU.2010$gdp)\nabline(fun.EU.2010, lty = 2, col=\"red\", lwd=1.5)\n\nsummary(fun.EU.1990)\nsummary(fun.EU.2010)\n\nconfint(fun.EU.1990)\nconfint(fun.EU.2010)\n\n```\n\n\n# Sustainable Quality EU\n\n```{r}\ndf.sust.EU <- data.frame(Country=df.EU.2010$country)\n\ndf.sust.EU$DELTA_HALE <- round((df.EU.2010$hale - df.EU.1990$hale) / df.EU.1990$hale, 3) * 100\n\ndf.sust.EU$DELTA_YLD <- round((df.EU.2010$yld - df.EU.1990$yld) / df.EU.1990$yld, 3) * 100\n\ndf.sust.EU$QUALITYe <- round(df.sust.EU$DELTA_HALE / df.sust.EU$DELTA_YLD, 3)\n\n\ndf.sust.EU$DELTA_THE <- round((df.EU.2010$the - df.EU.1990$the) / df.EU.1990$the, 3)  * 100\n\ndf.sust.EU$DELTA_GDP <- round((df.EU.2010$gdp - df.EU.1990$gdp) / df.EU.1990$gdp, 3)  * 100\n\ndf.sust.EU$COSTe <- round(df.sust.EU$DELTA_THE / df.sust.EU$DELTA_GDP, 3)\n\nprint(df.sust.EU, row.names = F)\n\nplot(density(df.sust.EU$QUALITYe), main=\"Sustainable Quality\", col=\"blue\", lty=1, axes=F, lwd=2, xlab=\"QUALITYe, COSTe\", ylab = \"Frequency\", ylim=c(0,3), xlim=c(0,2.5))\nlines(density(df.sust.EU$COSTe), col=\"red\", lty=1, lwd=2)\n\naxis(1)\naxis(2)\n\nabline(v=mean(df.sust.EU$QUALITYe), lty=1, col=\"blue\", lwd=1)\nabline(v=mean(df.sust.EU$QUALITYe[df.sust.EU$Country == ID.EU]), lty=4, col=\"blue\", lwd=1)\n\nabline(v=mean(df.sust.EU$COSTe), lty=1, col=\"red\",  lwd=1)\nabline(v=mean(df.sust.EU$COSTe[df.sust.EU$Country == ID.EU]), lty=4, col=\"red\", lwd=1)\n\nabline(v=1, lty=1, col=\"black\",  lwd=2)\n\nlegend(1.65, 2.5, c(\"Density QUALITYe\",\"Density COSTe\", \n                   paste(\"EU QUALITYe =\",round(mean(df.sust.EU$QUALITYe),2)) , \n                   paste(\"EU COSTe =\",round(mean(df.sust.EU$COSTe),2)) ,\n                   paste(\"Italy QUALITYe =\",round(mean(df.sust.EU$QUALITYe[df.sust.EU$Country == ID.EU]),2)),\n                   paste(\"Italy COSTe =\",round(mean(df.sust.EU$COSTe[df.sust.EU$Country == ID.EU]),2))), \n       col=c(\"blue\", \"red\", \"blue\", \"red\", \"blue\", \"red\"), \n       bty=\"n\", \n       y.intersp=1.5, \n       lty=c(1,1,1,1,4,4), \n       cex = .75,\n       lwd=2)\n\n```\n\n\n```{r}\nlibrary(gmodels)\n\nfor (i in 1:nrow(df.sust.EU)) {\n        if (df.sust.EU$COSTe[i] > 1){\n                df.sust.EU$Sustainability[i]=\"NS\"\n        }\n        if (df.sust.EU$COSTe[i] <= 1){\n                df.sust.EU$Sustainability[i]=\"S\"\n        }\n        if (df.sust.EU$QUALITYe[i] >= 1){\n                df.sust.EU$Quality[i]=\"Q\"\n        }\n        if (df.sust.EU$QUALITYe[i] < 1){\n                df.sust.EU$Quality[i]=\"NQ\"\n        }\n}       \n\ndf.sust.EU\n\nwith(df.sust.EU, CrossTable(Sustainability, Quality, expected=T, digits=2, format = \"SPSS\"))\n\nlibrary(ReporteRs)\nMyFTable <- vanilla.table(df.sust.EU)\nMyFTable <- setFlexTableWidths( MyFTable, widths = c(3, 1, 0.5, rep(0.7, 6) ) )\nMyFTable = setZebraStyle( MyFTable, odd = '#eeeeee', even = 'white' )\nMyFTable\nmydoc <- docx()\nmydoc <- addFlexTable(mydoc, flextable = MyFTable)\nwriteDoc(mydoc, file = \"MyFTable.docx\")\n\n\n```\n\n\n\n\n# Write files to excel for export to ppt\n```{r}\nrequire(xlsx)\nwrite.xlsx(df.EU.1990, \"df.EU.xlsx\", sheetName=\"1990\")\nwrite.xlsx(df.EU.2010, \"df.EU.xlsx\", sheetName=\"2010\", append=TRUE)\nwrite.xlsx(df.sust.EU, \"df.EU.xlsx\", sheetName=\"DELTA-EPSILON\", append=TRUE)\n\n```\n\n\n\n",
    "created" : 1467790263671.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1203151976",
    "id" : "EF073FCC",
    "lastKnownWriteTime" : 1467813479,
    "last_content_update" : 1467813479598,
    "path" : "~/Desktop/Capstone/HMS_SQIL_2017_Capstone/PreliminaryDataAnalysis.Rmd",
    "project_path" : "PreliminaryDataAnalysis.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}