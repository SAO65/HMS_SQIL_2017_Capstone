{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Preliminary Data Analysis\"\nauthor: \"Olgiati Stefano\"\ndate: \"25 May 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nrequire(data.table)\n\n```\n\n# Reading tidy data\n\n```{r echo=FALSE}\n\n\ndata.EU.1990 <- read.csv(\"Output_EU_1990.csv\")\ndata.EU.2010 <- read.csv(\"Output_EU_2010.csv\")\ndata.ROW.1990 <- read.csv(\"Output_ROW_1990.csv\")\ndata.ROW.2010 <- read.csv(\"Output_ROW_2010.csv\")\n\nhead(data.EU.1990)\nhead(data.EU.2010)\nhead(data.ROW.1990)\nhead(data.ROW.2010)\n\nattach(data.EU.1990)\nattach(data.EU.2010)\nattach(data.ROW.1990)\nattach(data.ROW.2010)\n\ndf.EU.1990 <- data.frame(country=data.EU.1990$country, le=data.EU.1990$le, hale=data.EU.1990$hale, yld=data.EU.1990$yld, the=data.EU.1990$the, gdp=data.EU.1990$gdp, the.gdp=data.EU.1990$the.gdp)\n\ndf.EU.2010 <- data.frame(country=data.EU.2010$country, le=data.EU.2010$le,hale=data.EU.2010$hale, yld=data.EU.2010$yld, the=data.EU.2010$the, gdp=data.EU.2010$gdp, the.gdp=data.EU.2010$the.gdp)\n\ndf.ROW.1990 <- data.frame(country=data.ROW.1990$country, le=data.ROW.1990$le,hale=data.ROW.1990$hale, yld=data.ROW.1990$yld, the=data.ROW.1990$the, gdp=data.ROW.1990$gdp, the.gdp=data.ROW.1990$the.gdp)\n\ndf.ROW.2010 <- data.frame(country=data.ROW.2010$country, le=data.ROW.2010$le,hale=data.ROW.2010$hale, yld=data.ROW.2010$yld, the=data.ROW.2010$the, gdp=data.ROW.2010$gdp, the.gdp=data.ROW.2010$the.gdp)\n\ndf.EU.1990\ndf.EU.2010\ndf.ROW.1990\ndf.ROW.2010\n\nID.ROW <- \"JPN\"\nID.EU <- \"ITA\"\n\n# Constant Scale in Graphs\n\nlim.le <- c(30, 85)\nlim.yld <- c(4, 15)\nlim.hale <- c(30, 85)\nlim.the <- c(100, 8500)\n\n```\n\n\n\n# Expansion of Morbidity WORLD: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.ROW.1990$hale, df.ROW.1990$yld, xlab=\"Health Adjusted Life Expectancy at Birth (hale)\", ylab=\"Years Lived with Disease (YLD)\", type=\"p\", col=\"grey\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.hale, ylim=lim.yld, axes=FALSE, frame.plot=FALSE)\n\npoints(df.ROW.2010$hale, df.ROW.2010$yld, col=\"darkslategrey\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\n\npoints(df.EU.1990$hale, df.EU.1990$yld, col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$hale, df.EU.2010$yld,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\naxis(1, at=c(round(min(df.EU.1990$hale), 1), round(median(df.EU.1990$hale), 1), round(max(df.EU.1990$hale), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(2, at=c(round(min(df.EU.1990$yld), 1), round(median(df.EU.1990$yld), 1), round(max(df.EU.1990$yld), 1)), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=round(df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$hale), 1), round(median(df.EU.2010$hale), 1), round(max(df.EU.2010$hale), 1)), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7,  tick=-.01)\n\naxis(4, at=c(round(min(df.EU.2010$yld), 1), round(median(df.EU.2010$yld), 1), round(max(df.EU.2010$yld), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlegend(30, 15, c(\"EU 1990\",\"EU 2010\",\"ROW 1990\", \"ROW 2010\"), col=c(\"blue\", \"red\", \"grey\", \"darkslategrey\"), bty=\"n\", y.intersp=1.5, pch=c(16,16,16,16), cex = 1)\n\n\ntext(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW]+.3, labels=paste(ID.ROW, \"\"), cex= .8, pos=4, offset = .2)\n\nabline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\nID.min = df.ROW.2010$country[df.ROW.2010$yld == min(df.ROW.2010$yld)]\nID.min\n\nID.max = df.ROW.2010$country[df.ROW.2010$yld == max(df.ROW.2010$yld)]\nID.max\n\ntext(df.ROW.2010$hale[df.ROW.2010$country == ID.min], df.ROW.2010$yld[df.ROW.2010$country == ID.min]+.2, labels=ID.min, cex= .8, pos=4, offset = .2)\n\ntext(df.ROW.2010$hale[df.ROW.2010$country == ID.max], df.ROW.2010$yld[df.ROW.2010$country == ID.max]+.2, labels=ID.max, cex= .8, pos=4, offset = .2)\n\n```\n\n\n\n# Increased Expansion of Morbidity EU: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.EU.1990$hale, df.EU.1990$yld, xlab=\"Health Adjusted Life Expectancy at Birth (hale)\", ylab=\"Years Lived with Disease (YLD)\", col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.hale, ylim=lim.yld, axes=FALSE, frame.plot=FALSE)\n\npoints(df.EU.2010$hale, df.EU.2010$yld,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.1990$hale[df.EU.1990$country == ID.EU], df.EU.1990$yld[df.EU.1990$country == ID.EU],  col=\"black\", pch = 5, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$hale[df.EU.2010$country == ID.EU], df.EU.2010$yld[df.EU.2010$country == ID.EU],  col=\"black\", pch = 9, cex = 1.3, lty = \"solid\", lwd = 2)\n\naxis(1, at=c(round(min(df.EU.1990$hale), 1), round(median(df.EU.1990$hale), 1), round(max(df.EU.1990$hale), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(2, at=c(round(min(df.EU.1990$yld), 1), round(median(df.EU.1990$yld), 1), round(max(df.EU.1990$yld), 1)), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=round(df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$hale), 1), round(median(df.EU.2010$hale), 1), round(max(df.EU.2010$hale), 1)), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7,  tick=-.01)\n\naxis(4, at=c(round(min(df.EU.2010$yld), 1), round(median(df.EU.2010$yld), 1), round(max(df.EU.2010$yld), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlegend(30, 15, c(\"EU 1990\",\"EU 2010\",\"ITA 1990\", \"ITA 2010\", \"JPN 2010\"), col=c(\"blue\", \"red\", \"black\", \"black\", \"black\"), bty=\"n\", y.intersp=1.5, pch=c(16,16, 5, 9, 8), cex = 1)\n\npoints(df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\nabline(h=df.ROW.2010$yld[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$hale[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\nfun.EU.1990 <- lm(df.EU.1990$yld ~ df.EU.1990$hale)\nabline(fun.EU.1990, lty = 2, col=\"blue\", lwd=1.5)\nsummary(fun.EU.1990)\nconfint(fun.EU.1990)\n\nfun.EU.2010 <- lm(df.EU.2010$yld ~ df.EU.2010$hale)\nabline(fun.EU.2010, lty = 2, col=\"red\", lwd=1.5)\nsummary(fun.EU.2010)\nconfint(fun.EU.2010)\n\n```\n\n\n\n# Expansion of Health Expenditure EU: 1990-2010\n\n```{r}\npar(mar=c(5, 4, 4, 5) + 0.1)\n\nplot(df.EU.1990$le, df.EU.1990$the, xlab=\"Life Expectancy at Birth\", ylab=\"Per Capita Total Health Expenditure\", col=\"blue\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2, xlim=lim.le, ylim=lim.the, axes=FALSE, frame.plot=FALSE)\n\npoints(df.EU.2010$le, df.EU.2010$the,  col=\"red\", pch = 16, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.1990$le[df.EU.1990$country == ID.EU], df.EU.1990$the[df.EU.1990$country == ID.EU],  col=\"black\", pch = 5, cex = 1.3, lty = \"solid\", lwd = 2)\n\npoints(df.EU.2010$le[df.EU.2010$country == ID.EU], df.EU.2010$the[df.EU.2010$country == ID.EU],  col=\"black\", pch = 9, cex = 1.3, lty = \"solid\", lwd = 2)\n\nlegend(65, 7000, c(\"EU 1990\",\"EU 2010\",\"ITA 1990\", \"ITA 2010\", \"JPN 2010\"), col=c(\"blue\", \"red\", \"black\", \"black\", \"black\"), bty=\"n\", y.intersp=1.5, pch=c(16,16, 5, 9, 8), cex = 1)\n\naxis(1, at=c(round(min(df.EU.1990$le), 1), round(median(df.EU.1990$le), 1), round(max(df.EU.1990$le), 1)), col.axis=\"blue\", col=\"blue\", las=2, cex.axis=0.7,  tick=-.01)\n\naxis(3, at=round(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], 2), col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\n\nlow.the.1990 <- round(min(df.EU.1990$the), 0)\nmedian.the.1990 <- round(median(df.EU.1990$the), 0)\nhigh.the.1990 <- round(max(df.EU.1990$the), 0)\n\naxis(2, at=c(low.the.1990,median.the.1990, high.the.1990), col.axis=\"blue\", col=\"blue\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(3, at=c(round(min(df.EU.2010$le), 1), round(median(df.EU.2010$le), 1), round(max(df.EU.2010$le), 1)), col.axis=\"red\", col=\"red\", las=2, cex.axis=0.7, tick=-.01)\n\nlow.the.2010 <- round(min(df.EU.2010$the), 0)\nmedian.the.2010 <- round(median(df.EU.2010$the), 0)\nhigh.the.2010 <- round(max(df.EU.2010$the), 0)\njapan.the.2010 <- round(df.ROW.2010$the[df.ROW.2010$country == ID.ROW], 1)\n\naxis(4, at=c(low.the.2010,median.the.2010, high.the.2010), col.axis=\"red\", col=\"red\",las=2, cex.axis=0.7, tick=-.01)\n\naxis(4, at=japan.the.2010, col.axis=\"black\", col=\"black\",las=2, cex.axis=0.7, tick=-.01)\n\npoints(df.ROW.2010$le[df.ROW.2010$country == ID.ROW], df.ROW.2010$the[df.ROW.2010$country == ID.ROW], col=\"black\", pch = 8, cex = 1.3, lty = \"solid\", lwd = 2)\n\nabline(h=df.ROW.2010$the[df.ROW.2010$country == ID.ROW], v=df.ROW.2010$le[df.ROW.2010$country == ID.ROW], lty=1, lwd=1)\n\n\nfun.EU.1990 <- lm(df.EU.1990$the ~ df.EU.1990$le)\nabline(fun.EU.1990, lty = 2, col=\"blue\", lwd=1.5)\n\nfun.EU.2010 <- lm(df.EU.2010$the ~ df.EU.2010$le)\nabline(fun.EU.2010, lty = 2, col=\"red\", lwd=1.5)\n\nsummary(fun.EU.1990)\nsummary(fun.EU.2010)\n\nconfint(fun.EU.1990)\nconfint(fun.EU.2010)\n\n```\n\n\n# Sustainable Quality EU\n\n```{r}\ndf.sust.EU <- data.frame(Country=df.EU.2010$country)\n\ndf.sust.EU$DELTA_HALE <- round((df.EU.2010$hale - df.EU.1990$hale) / df.EU.1990$hale, 3) * 100\n\ndf.sust.EU$DELTA_YLD <- round((df.EU.2010$yld - df.EU.1990$yld) / df.EU.1990$yld, 3) * 100\n\ndf.sust.EU$QUALITYe <- round(df.sust.EU$DELTA_HALE / df.sust.EU$DELTA_YLD, 3)\n\n\ndf.sust.EU$DELTA_THE <- round((df.EU.2010$the - df.EU.1990$the) / df.EU.1990$the, 3)  * 100\n\ndf.sust.EU$DELTA_GDP <- round((df.EU.2010$gdp - df.EU.1990$gdp) / df.EU.1990$gdp, 3)  * 100\n\ndf.sust.EU$COSTe <- round(df.sust.EU$DELTA_THE / df.sust.EU$DELTA_GDP, 3)\n\ndf.sust.EU$VALUEe <- round(df.sust.EU$QUALITYe / df.sust.EU$COSTe, 3)\n\nprint(df.sust.EU, row.names = F)\n\n(ID.EU.Value <- df.sust.EU$Country[df.sust.EU$VALUEe == max(df.sust.EU$VALUEe)])\n\n```\n\n\nQUALITYe\n\n```{r}\nX <- df.sust.EU$VALUEe\nXX <- df.sust.EU$VALUEe[df.sust.EU$Country == ID.EU]\n\nmu=mean(X); var=var(X)\nmu\nvar\nestBetaParams <- function(mu, var) {\n  alpha <- ((1 - mu) / var - 1 / mu) * mu ^ 2\n  beta <- alpha * (1 / mu - 1)\n  return(params = list(alpha = alpha, beta = beta))\n}\nestBetaParams(mu, var)\n\ny=function (x) dbeta(x,estBetaParams(mu, var)$alpha\n,estBetaParams(mu, var)$beta)\ncurve(y, from=0, to=1.5, col=\"blue\", axes=F, lwd=2, xlab=\"VALUEe\", ylab = \"\", ylim=c(0,3))\naxis(1)\naxis(1, at=round(qbeta(.025,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta), 2))\naxis(1, at=round(qbeta(.975,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta), 2))\naxis(2)\n\nlines(density(df.sust.EU$VALUEe), col=\"skyblue\", lwd=2)\nlines(density(df.sust.EU$QUALITYe), col=\"black\", lwd=2)\nlines(density(df.sust.EU$COSTe), col=\"slategrey\", lwd=2)\n\nabline(v=qbeta(.025,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta), lty=3)\nabline(v=qbeta(.975,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta), lty=3)\nabline(v=mean(X), col=\"black\", lty=4)\nabline(v=XX, col=\"red\")\nlegend(.8, 2.5, c(\"Density\",\"Beta Distribution\",paste(\"EU mean=\", round(mean(X),2)),paste(\"EU 95% CI=\", round(qbeta(.025,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta),3),\"-\", round(qbeta(.975,estBetaParams(mu, var)$alpha,estBetaParams(mu, var)$beta),3)), paste(ID.EU,\"=\", round(XX, 3))), col=c(\"skyblue\", \"blue\", \"blue\", \"black\", \"red\"), bty=\"n\", y.intersp=1.5, lty=c(1,1,4,3, 1), cex = 1, lwd=1)\n\n```\n\n\n```{r}\ndbeta(x,estBetaParams(mu, var)$alpha, estBetaParams(mu, var)$beta)\n\nround(pbeta(.5,estBetaParams(mu, var)$alpha, estBetaParams(mu, var)$beta, lower.tail=F), 2)\n\nround(pbeta(.5,estBetaParams(mu, var)$alpha, estBetaParams(mu, var)$beta, lower.tail=T), 2)\n\n```\n\n# Write files to excel for export to ppt\n```{r}\nrequire(xlsx)\nwrite.xlsx(df.EU.1990, \"df.EU.xlsx\", sheetName=\"1990\")\nwrite.xlsx(df.EU.2010, \"df.EU.xlsx\", sheetName=\"2010\", append=TRUE)\nwrite.xlsx(df.sust.EU, \"df.EU.xlsx\", sheetName=\"DELTA-EPSILON\", append=TRUE)\n\n```\n\n\n\n",
    "created" : 1467100780282.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1397663940",
    "id" : "8AD25B8F",
    "lastKnownWriteTime" : 1467190320,
    "last_content_update" : 1467190320659,
    "path" : "~/Desktop/Capstone/HMS_SQIL_2017_Capstone/PreliminaryDataAnalysis.Rmd",
    "project_path" : "PreliminaryDataAnalysis.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}